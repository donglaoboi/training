var moqui={localeMap:{zh:"zh-cn"},isString:function(a){return"string"===typeof a},isBoolean:function(a){return"boolean"===typeof a},isNumber:function(a){return"number"===typeof a},isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},isPlainObject:function(a){return null!=a&&"object"==typeof a&&"[object Object]"===Object.prototype.toString.call(a)},deepCopy:function(a){if("object"!==typeof a||
null===a)return a;var b=Array.isArray(a)?[]:{},c;for(c in a){var d=a[c];b[c]=moqui.deepCopy(d)}return b},objToSearch:function(a){var b="";moqui.isPlainObject(a)&&$.each(a,function(c,d){b=b+(0<b.length?"\x26":"")+c+"\x3d"+d});return b},searchToObj:function(a){if(!a||0===a.length)return{};var b={};a=a.split("\x26");for(var c=0;c<a.length;c++){var d=a[c].split("\x3d");if(1<d.length){var e=d[0];d=d[1];var f=b[e];f?moqui.isArray(f)?f.push(d):b[e]=[f,d]:b[e]=d}}return b},parseHref:function(a){var b={protocol:"",
host:"",path:"/",query:{},search:"",hash:"",name:""},c=a.indexOf("://");if(0<=c){b.protocol=a.slice(0,c);var d=a.indexOf("/",c+3);if(-1===d)return a.length>c+3&&(b.host=a.slice(c+3)),b;b.host=a.slice(c+3,d);a=a.slice(d)}c=a.split("#");1<c.length&&c[1].length&&(b.hash=c[1],a=c[0]);a=a.split("?");1<a.length&&a[1].length&&(c=a[1],b.search=c,b.query=moqui.searchToObj(c));a=a[0];b.path=a;a.length&&(c=a.lastIndexOf("/"),b.name=-1===c?a:a.slice(c+1));return b},makeHref:function(a){var b="";a.protocol&&a.protocol.length&&
(b+=a.protocol+"://");a.host&&a.host.length&&(b+=a.host);b+=a.path||"/";if(a.search&&a.search.length)b+="?"+a.search;else if(a.query){var c=moqui.objToSearch(a.query);c&&c.length&&(b+="?"+c)}a.hash&&a.hash.length&&(b+="#"+a.hash);return b},htmlEncode:function(a){return $("\x3cdiv/\x3e").text(a).html()},htmlDecode:function(a){return $("\x3cdiv/\x3e").html(a).text()},loadScript:function(a,b,c){var d=null;$("head script").each(function(f,g){-1!==g.src.indexOf(a)&&(d=g)});if(d)b&&(c?moqui.retryValidateCallback(function(){b(null,
d)},c):b(null,d));else{var e=document.createElement("script");e.src=a;e.async=!1;b&&(e.onload=function(){this.onerror=this.onload=null;c?moqui.retryValidateCallback(function(){b(null,e)},c):b(null,e)},e.onerror=function(){this.onerror=this.onload=null;var f=Error("Error loading script "+this.src);console.error(f);b(f,e)});document.head.appendChild(e)}},retryValidateCallback:function(a,b,c){!b||b()?a():(c||(c=1),8>=c&&setTimeout(moqui.retryValidateCallback,c*c*100,a,b,c+1))},loadStylesheet:function(a,
b,c){b||(b="stylesheet");c||(c="text/css");var d=!1;$("head link").each(function(f,g){-1!==g.href.indexOf(a)&&(d=!0)});if(!d){var e=document.createElement("link");e.href=a;e.rel=b;e.type=c;document.head.appendChild(e)}},retryInlineScript:function(a,b){try{eval(a)}catch(d){a=a.trim();var c=5>=b?b*b*100:-1;console.warn("inline script error "+b+" retry "+c+" script: "+a.slice(0,80)+"...");console.warn(d);5>=b&&setTimeout(moqui.retryInlineScript,c,a,b+1)}},decimalSeparator:(1.1).toLocaleString().substring(1,
2),thousandSeparator:(1E3).toLocaleString().substring(1,2),isStringInteger:function(a){if(!moqui.isString(a))return!1;for(var b=0;b<a.length;b++){var c=a[b];if(!("0"<=c&&"9">=c||0===b&&"-"===c||c===moqui.thousandSeparator))return!1}return!0},isStringNumber:function(a){if(!moqui.isString(a))return!1;for(var b=0;b<a.length;b++){var c=a[b];if(!("0"<=c&&"9">=c||0===b&&"-"===c||c===moqui.thousandSeparator||c===moqui.decimalSeparator))return!1}return!0},parseNumber:function(a){a=a.replaceAll(moqui.thousandSeparator,
"");return-1===a.indexOf(moqui.decimalSeparator)?parseInt(a):parseFloat(a)},format:function(a,b,c){b&&b.length&&(b=b.replace(/a/,"A").replace(/d/,"D").replace(/y/,"Y"));if(c&&c.length){c=c.toLowerCase();if("date"===c)return b&&0!==b.length||(b="YYYY-MM-DD"),moment(a).format(b);if("time"===c)return b&&0!==b.length||(b="HH:mm:ss"),moment(a).format(b);if("timestamp"===c)return b&&0!==b.length||(b="YYYY-MM-DD HH:mm"),moment(a).format(b);if("bigdecimal"===c||"currency"===c)return a.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,
"$1,");if("long"===c||"integer"===c||"double"===c||"float"===c)return a.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");console.warn("format type unknown: "+c)}if(moqui.isNumber(a))return a.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");c=moment(a);return c.isValid()?(b&&0!==b.length||(b="YYYY-MM-DD HH:mm"),c.format(b)):a},debounce:function(a,b){var c,d;return function(){var e=this,f=arguments;clearTimeout(c);c=setTimeout(function(){c=null;d=a.apply(e,f)},b);return d}},makeColumnsConsistent:function(a){a=
$("#"+a+" table");var b=[],c,d;for(c=0;c<a.length;c++){var e=a[c];if(e.rows&&0!==e.rows.length){var f=0;for(d=e.rows[f];5>f&&f<e.rows.length;)if((!d.cells||1>=d.cells.length)&&e.rows.length>f+1)f++,d=e.rows[f];else break;if(d.cells&&0!==d.cells.length)for(e=0;e<d.cells.length;e++){var g=$(d.cells[e]).width();if(!b[e]||b[e]<g)b[e]=g}}}d=b.length;for(c=e=0;c<d;c++)e+=b[c];g=[];for(c=0;c<d;c++)g[c]=100*b[c]/e;for(c=0;c<a.length;c++)if(e=a[c],e.rows&&0!==e.rows.length){f=0;for(d=e.rows[f];5>f&&f<e.rows.length;)if((!d.cells||
1>=d.cells.length)&&e.rows.length>f+1)f++,d=e.rows[f];else break;if(d.cells&&0!==d.cells.length)for(e=0;e<d.cells.length;e++)d.cells[e].style.width=g[e]+"%"}},downloadData:function(a,b,c){a=new Blob([a],{type:c});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(a,b);else{var d=document.createElement("a"),e=URL.createObjectURL(a);d.href=e;d.download=b;document.body.appendChild(d);d.click();setTimeout(function(){document.body.removeChild(d);window.URL.revokeObjectURL(e)},0)}},
notifyNotification:function(a,b){if(a){var c={};a.topic&&a.topic.length&&(c.tag=a.topic);if(window.Notification&&"granted"===Notification.permission){var d=new Notification(a.title,c);a.link&&a.link.length&&(d.onclick=function(){window.open(a.link)});moqui.webrootVue&&moqui.webrootVue.addNotify(a.title,a.type)}else window.Notification&&"denied"!==Notification.permission?Notification.requestPermission(function(e){"granted"===e?(e=new Notification(a.title,c),a.link&&a.link.length&&(e.onclick=function(){window.open(a.link)}),
moqui.webrootVue&&moqui.webrootVue.addNotify(a.title,a.type)):b(a)}):b(a)}},NotifyOptions:function(a,b,c,d){this.message=moqui.htmlEncode(a);b&&(this.url=b);this.icon=d?d:"success"===c?"fa fa-check-circle":"warning"===c?"fa fa-exclamation-triangle":"danger"===c?"fa fa-exclamation-circle":"fa fa-info-circle"},NotifySettings:function(a){this.delay=4E3;this.offset={x:20,y:60};this.placement={from:"top",align:"right"};this.animate={enter:"animated fadeInDown",exit:""};this.type=a?a:"info";this.template=
'\x3cdiv data-notify\x3d"container" class\x3d"notify-container col-xs-11 col-sm-3 alert alert-{0}" role\x3d"alert"\x3e\x3cbutton type\x3d"button" aria-hidden\x3d"true" class\x3d"close" data-notify\x3d"dismiss"\x3e\x26times;\x3c/button\x3e\x3cspan data-notify\x3d"icon"\x3e\x3c/span\x3e \x3cspan data-notify\x3d"message"\x3e{2}\x3c/span\x3e\x3ca href\x3d"{3}" target\x3d"{4}" data-notify\x3d"url"\x3e\x3c/a\x3e\x3c/div\x3e'},notifyGrowl:function(a){if(a){var b=new moqui.NotifySettings(a.type);!0===a.alertNoAutoHide&&
(b.delay=0);$.notify(new moqui.NotifyOptions(a.title,a.link,a.type,a.icon),b);moqui.webrootVue&&moqui.webrootVue.addNotify(a.title,a.type)}},NotificationClient:function(a){this.displayEnable=!0;this.webSocketUrl=a;this.topicListeners={};this.disableDisplay=function(){this.displayEnable=!1};this.enableDisplay=function(){this.displayEnable=!0};this.initWebSocket=function(){this.webSocket=new WebSocket(this.webSocketUrl);this.webSocket.clientObj=this;this.webSocket.onopen=function(b){this.clientObj.tryReopenCount=
0;b=[];for(var c in this.clientObj.topicListeners)b.push(c);this.send("subscribe:"+b.join(","))};this.webSocket.onmessage=function(b){var c=JSON.parse(b.data);(b=this.clientObj.topicListeners[c.topic])&&b.forEach(function(d){d(c,this)},this);(b=this.clientObj.topicListeners.ALL)&&b.forEach(function(d){d(c,this)},this)};this.webSocket.onclose=function(b){console.log(b);setTimeout(this.clientObj.tryReopen,3E4,this.clientObj)};this.webSocket.onerror=function(b){console.log(b)}};this.tryReopen=function(b){b.webSocket&&
b.webSocket.readyState!==WebSocket.CLOSED&&b.webSocket.readyState!==WebSocket.CLOSING||b.tryReopenCount&&!(6>b.tryReopenCount)||(console.log("Trying WebSocket reopen, count "+b.tryReopenCount),b.tryReopenCount=(b.tryReopenCount||0)+1,b.initWebSocket())};this.displayNotify=function(b,c){c.clientObj.displayEnable&&b.title&&!0===b.showAlert&&moqui.notifyNotification(b,moqui.notifyGrowl)};this.registerListener=function(b,c){this.webSocket||this.initWebSocket();c||(c=this.displayNotify);var d=this.topicListeners[b];
d||(d=[],this.topicListeners[b]=d,this.webSocket.readyState===WebSocket.OPEN&&this.webSocket.send("subscribe:"+b));0>d.indexOf(c)&&d.push(c)}},BasicWebSocketClient:function(a,b){this.webSocketUrl=a;this.onDataFunction=b;this.initWebSocket=function(){this.webSocket=new WebSocket(this.webSocketUrl);this.webSocket.clientObj=this;this.webSocket.onopen=function(c){this.clientObj.tryReopenCount=0};this.webSocket.onmessage=function(c){this.clientObj.onDataFunction(c.data)};this.webSocket.onclose=function(c){console.log(c);
setTimeout(this.clientObj.tryReopen,3E4,this.clientObj)};this.webSocket.onerror=function(c){console.log(c)}};this.tryReopen=function(c){c.webSocket&&c.webSocket.readyState!==WebSocket.CLOSED&&c.webSocket.readyState!==WebSocket.CLOSING||c.tryReopenCount&&!(6>c.tryReopenCount)||(console.log("Trying WebSocket reopen, count "+c.tryReopenCount),c.tryReopenCount=(c.tryReopenCount||0)+1,c.initWebSocket())};this.initWebSocket()},LruMap:function(a){this.limit=a;this.valueMap={};this.lruList=[];this.put=function(b,
c){var d=this.lruList,e=this.valueMap;e[b]=c;for(this._keyUsed(b);d.length>this.limit;)b=d.pop(),e[b]=null};this.get=function(b){var c=this.valueMap[b];c&&this._keyUsed(b);return c};this.containsKey=function(b){return!!this.valueMap[b]};this._keyUsed=function(b){for(var c=this.lruList,d=-1,e=0;e<c.length;e++)if(c[e]===b){d=e;break}0<=d&&c.splice(d,1);c.unshift(b)}}};
$.fn.select2&&($.fn.select2.defaults.set("theme","bootstrap"),$.fn.select2.defaults.set("minimumResultsForSearch","10"),$.fn.select2.defaults.set("dropdownAutoWidth",!0),$.fn.select2.amd.require(["select2/selection/search"],function(a){var b=a.prototype.searchRemoveChoice;a.prototype.searchRemoveChoice=function(){b.apply(this,arguments);this.$search.val("")}}),$.fn.select2.defaults.set("selectOnClose",!0),$(function(){$(".select2-hidden-accessible").on("select2:select",function(a){$(this).valid()})}),
$.fn.modal&&($.fn.modal.Constructor.prototype.enforceFocus=function(){}));
$.validator&&($.validator.setDefaults({errorPlacement:function(a,b){b.parent(".twitter-typeahead").length?a.insertAfter(b.parent()):b.parent(".input-group").length?a.insertAfter(b.parent()):b.hasClass("select2-hidden-accessible")?a.insertAfter(b.next("span")):a.insertAfter(b)}}),$.validator.prototype.errorsFor=function(a){a=this.escapeCssMeta(this.idOrName(a));var b="label[for\x3d'"+a+"'], label[for\x3d'"+a+"'] *";"label"!==this.settings.errorElement&&(b=b+", #"+a+"-error");return this.errors().filter(b)},
$.validator.prototype.errors=function(){var a=this.settings.errorClass.split(" ").join(".");return this.errorContext.is&&this.errorContext.is("form")?$(this.currentForm.elements).parents().parents().find(this.settings.errorElement+"."+a):$(this.settings.errorElement+"."+a,this.errorContext)},$.validator.prototype.elements=function(){var a=this,b={};return $(this.currentForm.elements).filter(":input, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var c=
this.name||$(this).attr("name");!c&&window.console&&console.error("%o has no name assigned",this);this.hasAttribute("contenteditable")&&(this.form=$(this).closest("form")[0],this.name=c);return c in b||!a.objectLength($(this).rules())?!1:b[c]=!0})},$.validator.prototype.init=function(){function a(e){!this.form&&this.hasAttribute("contenteditable")&&(this.form=$(this).closest("form")[0],this.name=$(this).attr("name"));var f=$.data(this.form,"validator"),g="on"+e.type.replace(/^validate/,""),h=f.settings;
h[g]&&!$(this).is(h.ignore)&&h[g].call(f,this,e)}this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var b=this.groups={};$.each(this.settings.groups,function(e,f){"string"===typeof f&&(f=f.split(/\s/));$.each(f,function(g,
h){b[h]=e})});var c=this.settings.rules;$.each(c,function(e,f){c[e]=$.validator.normalizeRule(f)});var d=$(this.currentForm.elements).filter(":input, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore);d.on("focusin.validate focusout.validate keyup.validate",a);d.on("click.validate","select, option, [type\x3d'radio'], [type\x3d'checkbox']",a)});
window.Inputmask&&Inputmask.extendAliases({"yyyy-mm-dd hh:mm":{mask:"y-1-2 h:s",placeholder:"yyyy-mm-dd hh:mm",alias:"datetime",separator:"-",leapday:"-02-29",regex:{val2pre:function(a){a=Inputmask.escapeRegex.call(this,a);return new RegExp("((0[13-9]|1[012])"+a+"[0-3])|(02"+a+"[0-2])")},val2:function(a){a=Inputmask.escapeRegex.call(this,a);return new RegExp("((0[1-9]|1[012])"+a+"(0[1-9]|[12][0-9]))|((0[13-9]|1[012])"+a+"30)|((0[13578]|1[02])"+a+"31)")},val1pre:/[01]/,val1:/0[1-9]|1[012]/},onKeyDown:function(a,
b,c,d){}}});